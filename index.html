<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Padaria Doce Sabor</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Poppins", Arial, sans-serif;
      background: linear-gradient(135deg, #f8e1d4, #fcefe9);
      color: #333;
    }

    .container {
      width: 100%;
      max-width: 420px;
      margin: 60px auto;
      padding: 30px;
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      animation: fadeIn 0.8s ease-in-out;
    }

    h2 { text-align: center; margin-bottom: 20px; color: #6b2e1f; }

    label {
      font-weight: bold; color: #6b2e1f;
      display: block; margin-top: 10px;
    }

    input {
      width: 100%; padding: 12px; margin: 8px 0;
      border-radius: 10px; border: 1px solid #bbb;
      outline: none; transition: 0.3s;
    }

    input:focus { border-color: #6b2e1f; box-shadow: 0 0 5px #6b2e1f77; }

    button {
      width: 100%; padding: 14px; background: #6b2e1f;
      color: white; border: none; border-radius: 25px;
      cursor: pointer; font-size: 16px; margin-top: 15px;
      transition: 0.3s;
    }
    button:hover { background: #4d2015; transform: scale(1.05); }

    nav {
      background: #6b2e1f; color: white; padding: 15px;
      display: flex; justify-content: space-between; align-items: center;
    }

    nav h1 { font-size: 22px; }

    .menu { display: flex; gap: 15px; }

    .menu button {
      background: #fff; color: #6b2e1f;
      padding: 8px 16px; border-radius: 15px;
      border: none; font-size: 14px; font-weight: bold;
      cursor: pointer; transition: 0.3s;
    }

    .menu button:hover { background: #f2c6b4; }

    .padaria {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      padding: 30px;
    }

    .produto {
      background: white; padding: 20px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      text-align: center;
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
    }

    .produto:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }

    .produto img {
      width: 100%; height: 180px; object-fit: cover;
      border-radius: 12px; margin-bottom: 12px;
    }

    .produto h3 { color: #6b2e1f; margin-bottom: 8px; }

    .descricao {
      display: none;
      margin-top: 10px;
      font-size: 14px;
      color: #444;
    }

    .perfil { padding: 30px; }

    .perfil h2 {
      margin-bottom: 15px;
      color: #6b2e1f;
    }

    .perfil p { margin: 8px 0; font-size: 15px; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden { display: none; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .card { background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 3px 8px rgba(0,0,0,0.1); }
  </style>
</head>
<body>

  <!-- Cadastro -->
  <div id="cadastro" class="container hidden">
    <h2>Cadastro de Funcion√°rio</h2>
    <label>Nome</label>
    <input type="text" id="nome">
    <label>Telefone</label>
    <input type="text" id="telefone">
    <label>Email</label>
    <input type="email" id="emailCadastro">
    <label>Senha</label>
    <input type="password" id="senhaCadastro">
    <label>Rua</label>
    <input type="text" id="rua">
    <label>N¬∫</label>
    <input type="text" id="numero">
    <label>Complemento</label>
    <input type="text" id="complemento">
    <label>CEP</label>
    <input type="text" id="cep">
    <button onclick="criarConta()">Cadastrar</button>
  </div>

  <!-- Login -->
  <div id="login" class="container hidden">
    <h2>Login</h2>
    <label>Email</label>
    <input type="email" id="emailLogin">
    <label>Senha</label>
    <input type="password" id="senhaLogin">
    <button onclick="fazerLogin()">Entrar</button>
    <button onclick="mostrarCadastro()" style="margin-top:10px; background:#6b2e1f;">Criar Conta</button>
  </div>

  <!-- Site -->
  <div id="sitePadaria" class="hidden">
    <nav>
      <h1>üçû Padaria Doce Sabor üç∞</h1>
      <div class="menu">
        <button onclick="mostrarLoja()">Loja</button>
        <button onclick="mostrarPerfil()">Perfil</button>
        <button onclick="mostrarPerfilAdm()">Admin</button>
        <button onclick="logout()">Sair</button>
      </div>
    </nav>

    <!-- Loja -->
    <div id="loja" class="padaria"></div>

    <!-- Perfil -->
    <div id="perfil" class="perfil hidden">
      <h2>Alterar Perfil</h2>
      <label>Nome</label><input type="text" id="pNome">
      <label>Telefone</label><input type="text" id="pTelefone">
      <label>Email</label><input type="email" id="pEmail">
      <label>Rua</label><input type="text" id="pRua">
      <label>N¬∫</label><input type="text" id="pNumero">
      <label>Complemento</label><input type="text" id="pComplemento">
      <label>CEP</label><input type="text" id="pCep">
      <button onclick="salvarPerfil()">Salvar Altera√ß√µes</button>
    </div>

    <!-- Admin -->
    <div id="perfilAdm" class="perfil hidden">
      <h2>√Årea do Administrador</h2>
      <div id="adminProdutos" class="grid"></div>
      <button onclick="salvarProdutos()">Salvar Altera√ß√µes</button>
    </div>
  </div>

<script>
async function criarConta() {
  const dados = {
    nome: document.getElementById("nome").value,
    telefone: document.getElementById("telefone").value,
    email: document.getElementById("emailCadastro").value,
    senha: document.getElementById("senhaCadastro").value,
    rua: document.getElementById("rua").value,
    numero: document.getElementById("numero").value,
    complemento: document.getElementById("complemento").value,
    cep: document.getElementById("cep").value,
  };

  const r = await fetch("api/cadastro.php", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(dados)
  }).then(res => res.json());

  if (r.status === "ok") {
    alert("Cadastro realizado com sucesso!");
    document.getElementById("cadastro").classList.add("hidden");
    document.getElementById("login").classList.remove("hidden");
  } else {
    alert("Erro no cadastro!");
  }
}

async function fazerLogin() {
  const email = document.getElementById("emailLogin").value;
  const senha = document.getElementById("senhaLogin").value;

  const r = await fetch("api/login.php", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, senha })
  }).then(res => res.json());

  if (r.status === "ok") {
    window.usuario = r.usuario;
    document.getElementById("login").classList.add("hidden");
    document.getElementById("sitePadaria").classList.remove("hidden");
    carregarProdutos();
  } else {
    alert("Email ou senha incorretos!");
  }
}

async function carregarProdutos() {
  const produtos = await fetch("api/produtos.php").then(r => r.json());
  const loja = document.getElementById("loja");
  loja.innerHTML = "";
  produtos.forEach(p => {
    loja.innerHTML += `
      <div class="produto" onclick="toggleDescricao(this)">
        <img src="${p.img}" alt="${p.nome}">
        <h3>${p.nome}</h3>
        <p><strong>R$ ${p.preco}</strong></p>
        <div class="descricao">${p.descricao}</div>
      </div>`;
  });

  const admin = document.getElementById("adminProdutos");
  admin.innerHTML = "";
  produtos.forEach(p => {
    admin.innerHTML += `
      <div class="card">
        <label>Nome</label>
        <input type="text" id="admNome${p.id}" value="${p.nome}">
        <label>Pre√ßo</label>
        <input type="text" id="admPreco${p.id}" value="${p.preco}">
        <label>Descri√ß√£o</label>
        <input type="text" id="admDescricao${p.id}" value="${p.descricao}">
      </div>`;
  });
}

async function salvarProdutos() {
  const cards = document.querySelectorAll("#adminProdutos .card");
  const atualizados = [...cards].map(card => {
    const id = card.querySelector("input").id.replace("admNome", "");
    return {
      id: parseInt(id),
      nome: document.getElementById("admNome" + id).value,
      preco: parseFloat(document.getElementById("admPreco" + id).value),
      descricao: document.getElementById("admDescricao" + id).value
    };
  });

  const r = await fetch("api/editar_produtos.php", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(atualizados)
  }).then(res => res.json());

  if (r.status === "ok") {
    alert("Produtos atualizados!");
    carregarProdutos();
  }
}

function toggleDescricao(card) {
  const desc = card.querySelector(".descricao");
  desc.style.display = desc.style.display === "block" ? "none" : "block";
}

function logout() {
  document.getElementById("sitePadaria").classList.add("hidden");
  document.getElementById("login").classList.remove("hidden");
}

function mostrarLoja() {
  document.getElementById("loja").classList.remove("hidden");
  document.getElementById("perfil").classList.add("hidden");
  document.getElementById("perfilAdm").classList.add("hidden");
}

function mostrarPerfil() {
  if (window.usuario) {
    document.getElementById("pNome").value = window.usuario.nome || "";
    document.getElementById("pTelefone").value = window.usuario.telefone || "";
    document.getElementById("pEmail").value = window.usuario.email || "";
    document.getElementById("pRua").value = window.usuario.rua || "";
    document.getElementById("pNumero").value = window.usuario.numero || "";
    document.getElementById("pComplemento").value = window.usuario.complemento || "";
    document.getElementById("pCep").value = window.usuario.cep || "";
  }
  document.getElementById("perfil").classList.remove("hidden");
  document.getElementById("loja").classList.add("hidden");
  document.getElementById("perfilAdm").classList.add("hidden");
}

function salvarPerfil() {
  alert("Altera√ß√£o de perfil no banco pode ser criada em outro endpoint PHP (ex: api/editar_usuario.php)");
}

function mostrarPerfilAdm() {
  document.getElementById("perfilAdm").classList.remove("hidden");
  document.getElementById("loja").classList.add("hidden");
  document.getElementById("perfil").classList.add("hidden");
  carregarProdutos();
}

function mostrarCadastro() {
  document.getElementById("login").classList.add("hidden");
  document.getElementById("cadastro").classList.remove("hidden");
}

window.onload = function() {
  document.getElementById("login").classList.remove("hidden");
};
</script>
</body>
</html>
